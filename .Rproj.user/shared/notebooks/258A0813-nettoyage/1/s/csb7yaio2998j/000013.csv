"0","# 2.1 Feature Engineering sur les données IRIS"
"0","# On crée des indicateurs parlants à partir des données brutes de 'actres_clean'."
"0",""
"0","# Petite fonction pour éviter les divisions par zéro, c'est une bonne pratique."
"0","safe_divide <- function(numerator, denominator) {"
"0","  # Si le dénominateur est 0 ou NA, on retourne 0, sinon on fait la division."
"0","  ifelse(is.na(denominator) | denominator == 0, 0, numerator / denominator)"
"0","}"
"0",""
"0",""
"0",""
"0","# La colonne clé de la commune est 'com'. La colonne département est 'dep'."
"0","communes_data <- actres_df %>%"
"0","  group_by(dep, com, libcom) %>% # On groupe par département ET commune"
"0","  summarise("
"0","    # On somme toutes les variables numériques qui nous intéressent"
"0","    across("
"0","      c(p21_act1564, p21_fact1564, c21_act1564_cs3, p21_fsal15p_tp, p21_factocc15p), "
"0","      ~sum(., na.rm = TRUE)"
"0","    ),"
"0","    .groups = ""drop"" # On retire le groupement après avoir sommé"
"0","  )"
"0",""
"0","cat(""✅ Données IRIS agrégées pour"", nrow(communes_data), ""communes.\n"")"
"1","✅ Données IRIS agrégées pour"
"1"," "
"1","34970"
"1"," "
"1","communes.
"

"0","master_df_historique <- egapro_prepared %>%"
"0","  "
"0","  # Jointure avec SIRENE pour la localisation. On ne garde que les entreprises"
"0","  # dont le siège social a pu être géolocalisé."
"0","  inner_join(sirene_clean, by = ""siren"") %>%"
"0","  "
"0","  # Jointure avec le fond de carte pour filtrer sur le périmètre géographique"
"0","  # et récupérer les informations EPT/DEP propres. On utilise st_drop_geometry"
"0","  # pour ne joindre que les attributs, pas les géométries."
"0","  inner_join("
"0","    st_drop_geometry(map_com_prepared), "
"0","    by = c(""code_commune"" = ""com_code"")"
"0","  ) %>%"
"0","  "
"0","  # Jointure avec les indicateurs socio-démographiques de la commune."
"0","  # On utilise une jointure à gauche au cas où certaines communes manqueraient."
"0","  left_join(communes_features, by = ""code_commune"")"
"0",""
"0","message("
"0","  ""✅ Table 'master_df_historique' finale créée avec "", "
"0","  scales::comma(nrow(master_df_historique)), "
"0","  "" observations (entreprise-année)."""
"0",")"
"2","✅ Table 'master_df_historique' finale créée avec 16,229 observations (entreprise-année).
"
